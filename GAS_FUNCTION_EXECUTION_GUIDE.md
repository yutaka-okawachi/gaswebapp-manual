# GASエディタで関数を実行する方法（詳細手順）

`setupGitHubCredentials()`をGASエディタで実行する手順を**画像付き**で説明します。

---

## 📋 ステップバイステップ

### ステップ1: スプレッドシートを開く

1. 該当するスプレッドシート（データが入っているスプレッドシート）を開く
2. URLに`SPREADSHEET_ID`が含まれているか確認:
   ```
   https://docs.google.com/spreadsheets/d/1WTZicVS_Dnu5PHQf1RPrXyS03LffwjbTwPu7bn61WTJTfQzTcimC5Pqs/
   ```

---

### ステップ2: Apps Scriptエディタを開く

1. メニューバーの **拡張機能** をクリック
2. **Apps Script** をクリック

```
┌─────────────────────────────────────┐
│ ファイル 編集 表示 挿入 表示形式      │
│ データ ツール 拡張機能 ヘルプ        │  ← ここ
│              └─ Apps Script ← クリック│
└─────────────────────────────────────┘
```

→ 新しいタブでGASエディタが開きます

---

### ステップ3: GASエディタの画面構成を確認

GASエディタが開くと、以下のような画面が表示されます：

```
┌───────────────────────────────────────────────────────┐
│ ◀ プロジェクト名                     デプロイ 実行 ▼  │ ← 上部ツールバー
├────────┬──────────────────────────────────────────────┤
│ ファイル │ // ここにコードが表示される                    │
│ ├─○ setup_credentials.js  ← 左側のファイルリスト      │
│ ├─  github_sync.js                                   │
│ └─  export_json.js                                   │
│                                                      │
│ サービス │ function setupGitHubCredentials() {         │
│ 設定    │   const ui = SpreadsheetApp.getUi();       │
│ ライブラリ│   ...                                       │
└────────┴──────────────────────────────────────────────┘
```

---

### ステップ4: 関数を選択して実行

#### 方法A: ドロップダウンから選択（推奨）

1. **上部ツールバー**の「実行」ボタンの**左側**にドロップダウンがあります
2. そこをクリックすると関数リストが表示されます：

```
┌─────────────────────────────────────┐
│ 関数を選択  ▼          実行          │
│     ↓クリック                        │
│ ┌─────────────────────┐            │
│ │ setupGitHubCredentials │ ← 選択   │
│ │ viewGitHubSettings     │          │
│ │ clearGitHubSettings    │          │
│ │ testGitHubSync         │          │
│ │ exportAllDataToJson    │          │
│ └─────────────────────┘            │
└─────────────────────────────────────┘
```

3. **`setupGitHubCredentials`** を選択
4. 右側の **実行** ボタン（▶ アイコン）をクリック

#### 方法B: コード内から実行

1. 左側のファイルリストから **`setup_credentials.js`** をクリック
2. コードエディタで `function setupGitHubCredentials()` の行を見つける
3. 関数名の**左側**に表示される **▶ 実行** ボタンをクリック

```javascript
▶ function setupGitHubCredentials() {  ← ここの▶をクリック
    const ui = SpreadsheetApp.getUi();
    ...
}
```

---

### ステップ5: 初回実行時の認証

初めて実行すると、**権限のリクエスト**が表示されます：

```
┌─────────────────────────────────────┐
│ 承認が必要です                        │
│                                     │
│ このプロジェクトを初めて実行する際    │
│ には、承認が必要です。                │
│                                     │
│        [権限を確認]  [キャンセル]     │
└─────────────────────────────────────┘
```

1. **権限を確認** をクリック
2. Googleアカウント選択画面が表示 → 自分のアカウントを選択
3. 警告画面が出たら:
   ```
   このアプリは Google で確認されていません
   ```
   - **詳細** をクリック
   - **（安全ではないページ）に移動** をクリック
4. 権限リクエスト画面で **許可** をクリック

---

### ステップ6: UIプロンプトで設定入力

認証が完了すると、スプレッドシートに**ダイアログボックス**が表示されます：

#### プロンプト1/4: GitHub Personal Access Token
```
┌─────────────────────────────────────┐
│ GitHub設定 - Step 1/4                │
│                                     │
│ GitHub Personal Access Token (PAT)  │
│ を入力してください:                   │
│                                     │
│ ┌─────────────────────────────────┐│
│ │ ghp_xxxxxxxxxxxxxxxxxxxx        ││ ← トークンを貼り付け
│ └─────────────────────────────────┘│
│                                     │
│           [OK]  [キャンセル]         │
└─────────────────────────────────────┘
```

→ 作成したトークンを貼り付けて **OK**

#### プロンプト2/4: GitHubユーザー名
```
┌─────────────────────────────────────┐
│ GitHub設定 - Step 2/4                │
│                                     │
│ GitHubユーザー名を確認してください:    │
│                                     │
│ ┌─────────────────────────────────┐│
│ │ yutaka-okawachi                 ││ ← 確認してOK
│ └─────────────────────────────────┘│
│                                     │
│           [OK]  [キャンセル]         │
└─────────────────────────────────────┘
```

→ そのまま **OK**（または修正してOK）

#### プロンプト3/4: リポジトリ名
```
┌─────────────────────────────────────┐
│ GitHub設定 - Step 3/4                │
│                                     │
│ リポジトリ名を確認してください:        │
│                                     │
│ ┌─────────────────────────────────┐│
│ │ gaswebapp-manual                ││ ← 確認してOK
│ └─────────────────────────────────┘│
│                                     │
│           [OK]  [キャンセル]         │
└─────────────────────────────────────┘
```

→ そのまま **OK**

#### プロンプト4/4: ブランチ名
```
┌─────────────────────────────────────┐
│ GitHub設定 - Step 4/4                │
│                                     │
│ プッシュ先のブランチ名を確認してくだ   │
│ さい:                               │
│                                     │
│ ┌─────────────────────────────────┐│
│ │ main                            ││ ← 確認してOK
│ └─────────────────────────────────┘│
│                                     │
│           [OK]  [キャンセル]         │
└─────────────────────────────────────┘
```

→ そのまま **OK**

---

### ステップ7: 完了確認

すべての入力が完了すると、**完了メッセージ**が表示されます：

```
┌─────────────────────────────────────┐
│ ✓ 設定完了                           │
│                                     │
│ 設定が完了しました！                  │
│                                     │
│ GitHub Owner: yutaka-okawachi       │
│ Repository: gaswebapp-manual        │
│ Branch: main                        │
│ Spreadsheet ID: 1WTZicVS_Dnu5...    │
│                                     │
│ 次のステップ:                         │
│ 1. github_sync.js の testGitHubSync()│
│    を実行してテスト                   │
│ 2. 問題なければ exportAllDataToJson()│
│    を実行                            │
│                                     │
│              [OK]                   │
└─────────────────────────────────────┘
```

→ **OK** をクリック

---

## 🎉 完了！

GASエディタの下部に**実行ログ**が表示されます：

```
┌─────────────────────────────────────┐
│ 実行ログ                             │
├─────────────────────────────────────┤
│ 13:45:23  情報  GitHub設定が保存されました
│ 13:45:23  情報  Owner: yutaka-okawachi
│ 13:45:23  情報  Repo: gaswebapp-manual
│ 13:45:23  情報  Branch: main
└─────────────────────────────────────┘
```

---

## 🧪 次は: テストを実行

同じ手順で **`testGitHubSync`** を実行してテストしましょう！

1. 関数ドロップダウンから **`testGitHubSync`** を選択
2. **実行** をクリック
3. 実行ログで「✓ テスト成功！」を確認
4. GitHubリポジトリで `test/gas_test.json` が作成されているか確認

---

## ⚠️ トラブルシューティング

### 関数リストに setupGitHubCredentials が表示されない

**原因**: スクリプトが正しく読み込まれていない  
**解決**: 
1. GASエディタをリロード（F5）
2. 左側のファイルリストに `setup_credentials.js` があるか確認

### 実行ボタンが押せない（グレーアウト）

**原因**: 関数が選択されていない  
**解決**: ドロップダウンから関数を選択

### エラー: "SpreadsheetApp is not defined"

**原因**: スタンドアロンスクリプトで実行している  
**解決**: 必ずスプレッドシートから「拡張機能 → Apps Script」で開く
