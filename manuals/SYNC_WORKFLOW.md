# データ同期ワークフロー (Sync Workflow)

このプロジェクトでは、ローカルのスプレッドシート関連データ（JSON）とGoogle Apps Script (GAS) を同期するために、`sync-data.ps1` スクリプトを使用します。

## スクリプトの概要

`sync-data.ps1` は以下の処理を一括で行います：

1.  **環境変数の読み込み**: `.env` ファイルから `GAS_DEPLOY_URL` と `GAS_SECRET_TOKEN` を読み込みます。
2.  **ソースコードの変更チェック**: `src/` ディレクトリに変更があるか確認します。
3.  **GASへのプッシュ (必要時)**: 変更がある場合、`clasp push` を実行して GAS にコードをアップロードします。
4.  **新しいデプロイの作成 (必要時)**: コードが更新された場合、新しいバージョンをデプロイし、ウェブアプリの URL を更新します。
5.  **データの同期**: GAS ウェブアプリのエンドポイント (`exportAllDataToJson`) を叩き、最新のデータを JSON としてダウンロードして `data/` ディレクトリに保存します。

## 実行方法

PowerShell で以下のコマンドを実行してください。

```powershell
.\sync-data.ps1
```

## トラブルシューティング

-   **404 エラー**: ウェブアプリの URL が古い可能性があります。`.env` ファイルの `GAS_DEPLOY_URL` が最新のデプロイを指しているか確認してください。
-   **認証エラー**: `.env` の `GAS_SECRET_TOKEN` が、GAS のスクリプトプロパティ `TOKEN` と一致しているか確認してください。
