# GitHub 公開に伴うセキュリティガイドライン

## 1. はじめに

本ドキュメントは、GitHub 上でリポジトリを公開（Public）にする際のリスク管理と、推奨される運用ルールをまとめたものです。
特に、Google Apps Script (GAS) と連携している本プロジェクトにおいて、機密情報の流出を防ぐための具体的な対策を定義します。

---

## 2. 外部公開によって生じる主な危険性と対策

### 2.1 ソースコード・設計思想の完全公開
- **状況**: アプリケーションのロジックやディレクトリ構成が第三者に把握されます。
- **対策**: 
    - 公開目的がないリポジトリは **Private** に設定してください。
    - 公開が必要な場合、`README.md` に「サンプル」または「マニュアル用」であることを明記し、不要なコメントや実験コードを整理してください。

### 2.2 設定ファイル・識別子の漏洩
- **状況**: `.clasp.json` の `scriptId` や、Google スプレッドシートの ID が公開されるリスクがあります。
- **対策**: 
    - `.clasp.json` は **絶対に Git の管理対象に含めない** でください（`.gitignore` で除外済み）。
    - スプレッドシート ID や Web アプリの URL は、ソースコード内に直接記述せず、環境変数（`.env` 等）やスクリプトプロパティで管理してください。

### 2.3 APIキー・認証情報の流出
- **状況**: `.env` ファイルやコード内の API キーが流出すると、不正利用される恐れがあります。
- **対策**: 
    - `.env` ファイルはローカルのみで管理し、GitHub にはプッシュしないでください。
    - 誤って公開してしまった場合は、即座にキーを無効化し、Git の履歴から完全に削除する作業（`git-filter-repo` 等）が必要です。

### 2.4 コミット履歴からの情報漏洩
- **状況**: 過去のコミットに削除済みの機密情報が残っている場合があります。
- **対策**: 
    - 秘密情報を削除するだけでなく、履歴そのものから抹消する必要があります。
    - コミット前に、機密情報が含まれていないか確認する癖をつけてください。

---

## 3. 本プロジェクトで実施した改善内容

本プロジェクトでは、セキュリティ向上のため以下の設定を適用しました：

1.  **`.gitignore` の強化**:
    - `.clasp.json`, `.env`, `deployments_list.txt`, `*.log` などの機密・不要ファイルを追跡対象外に設定。
2.  **既存の追跡解除**:
    - 誤って Git に登録されていた `.clasp.json` や `.env` を履歴の最新状態から削除（`git rm --cached`）。
3.  **ドキュメントのサニタイズ**:
    - `README.md` 等に含まれていた具体的な Web アプリ URL をダミー値（`YOUR_WEB_APP_ID`）に置換。

---

## 4. 開発者への推奨フロー

1.  **新規ファイルの作成時**: 秘匿情報が含まれる場合は、すぐに `.gitignore` に登録されているか確認してください。
2.  **秘密情報の管理**: API キーやトークンは、`.env` ファイルに記述し、コードからは `env` オブジェクトやスクリプトプロパティ経由で読み込むようにしてください。
3.  **公開前チェック**: 
    - 実 ID が残っていないか。
    - `/` コマンド等で自動的に push される範囲が意図通りか。

---

## 5. 結論

GitHub は強力な共有プラットフォームですが、一歩間違えると重大なセキュリティ事故につながります。「秘密情報はローカルで管理する」という原則を徹底し、安全な運用を心がけましょう。
